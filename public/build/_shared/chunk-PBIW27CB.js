import{a as He}from"/build/_shared/chunk-YZEJYO2E.js";import{c as De}from"/build/_shared/chunk-W5DRAD4K.js";var L=[],S=0,U=4,I=0,N=n=>{let e=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(r){return t.lc=e.push(r),()=>{for(let o=S+U;o<L.length;)L[o]===r?L.splice(o,U):o+=U;let i=e.indexOf(r);~i&&(e.splice(i,1),--t.lc||t.off())}},notify(r,i){I++;let o=!L.length;for(let l of e)L.push(l,t.value,r,i);if(o){for(S=0;S<L.length;S+=U)L[S](L[S+1],L[S+2],L[S+3]);L.length=0}},off(){},set(r){let i=t.value;i!==r&&(t.value=r,t.notify(i))},subscribe(r){let i=t.listen(r);return r(t.value),i},value:n};return t};var We=5,B=6,z=10,Re=(n,e,t,r)=>(n.events=n.events||{},n.events[t+z]||(n.events[t+z]=r(i=>{n.events[t].reduceRight((o,l)=>(l(o),o),{shared:{},...i})})),n.events[t]=n.events[t]||[],n.events[t].push(e),()=>{let i=n.events[t],o=i.indexOf(e);i.splice(o,1),i.length||(delete n.events[t],n.events[t+z](),delete n.events[t+z])});var Ue=1e3,ce=(n,e)=>Re(n,r=>{let i=e(r);i&&n.events[B].push(i)},We,r=>{let i=n.listen;n.listen=(...l)=>(!n.lc&&!n.active&&(n.active=!0,r()),i(...l));let o=n.off;return n.events[B]=[],n.off=()=>{o(),setTimeout(()=>{if(n.active&&!n.lc){n.active=!1;for(let l of n.events[B])l();n.events[B]=[]}},Ue)},()=>{n.listen=i,n.off=o}});var Be=(n,e,t)=>{Array.isArray(n)||(n=[n]);let r,i,o=()=>{if(i===I)return;i=I;let s=n.map(a=>a.get());if(!r||s.some((a,p)=>a!==r[p])){r=s;let a=e(...s);a&&a.then&&a.t?a.then(p=>{r===s&&l.set(p)}):(l.set(a),i=I)}},l=N(void 0),f=l.get;l.get=()=>(o(),f());let u,c=t?()=>{clearTimeout(u),u=setTimeout(o)}:o;return ce(l,()=>{let s=n.map(a=>a.listen(c));return o(),()=>{for(let a of s)a()}}),l},V=(n,e)=>Be(n,e);function Y(n,e,t){let r=new Set([...e,void 0]);return n.listen((i,o,l)=>{r.has(l)&&t(i,o,l)})}var D=(n={})=>{let e=N(n);return e.setKey=function(t,r){let i=e.value;typeof r>"u"&&t in e.value?(e.value={...e.value},delete e.value[t],e.notify(i,t)):e.value[t]!==r&&(e.value={...e.value,[t]:r},e.notify(i,t))},e};var C=De(He(),1),$=(n,e)=>t=>{n.current!==t&&(n.current=t,e())};function En(n,{keys:e,deps:t=[n,e]}={}){let r=(0,C.useRef)();r.current=n.get();let i=(0,C.useCallback)(l=>($(r,l)(n.value),e?.length>0?Y(n,e,$(r,l)):n.listen($(r,l))),t),o=()=>r.current;return(0,C.useSyncExternalStore)(i,o,o)}function de(n,e){let t,r=[],i=Promise.resolve(),o=()=>{t=self.setTimeout(async()=>{await i,r.length>0&&(i=Promise.resolve(e(r))),t=void 0,r=[]},n)};return(...l)=>{r.push(l),t||o()}}var ze="project",pe=`/home/${ze}`,G="gobezeai_file_modifications";function b(){}b.prototype={diff:function(e,t){var r,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.callback;typeof i=="function"&&(o=i,i={});var l=this;function f(d){return d=l.postProcess(d,i),o?(setTimeout(function(){o(d)},0),!0):d}e=this.castInput(e,i),t=this.castInput(t,i),e=this.removeEmpty(this.tokenize(e,i)),t=this.removeEmpty(this.tokenize(t,i));var u=t.length,c=e.length,s=1,a=u+c;i.maxEditLength!=null&&(a=Math.min(a,i.maxEditLength));var p=(r=i.timeout)!==null&&r!==void 0?r:1/0,g=Date.now()+p,v=[{oldPos:-1,lastComponent:void 0}],m=this.extractCommon(v[0],t,e,0,i);if(v[0].oldPos+1>=c&&m+1>=u)return f(ve(l,v[0].lastComponent,t,e,l.useLongestToken));var F=-1/0,E=1/0;function A(){for(var d=Math.max(F,-s);d<=Math.min(E,s);d+=2){var O=void 0,x=v[d-1],h=v[d+1];x&&(v[d-1]=void 0);var M=!1;if(h){var w=h.oldPos-d;M=h&&0<=w&&w<u}var y=x&&x.oldPos+1<c;if(!M&&!y){v[d]=void 0;continue}if(!y||M&&x.oldPos<h.oldPos?O=l.addToPath(h,!0,!1,0,i):O=l.addToPath(x,!1,!0,1,i),m=l.extractCommon(O,t,e,d,i),O.oldPos+1>=c&&m+1>=u)return f(ve(l,O.lastComponent,t,e,l.useLongestToken));v[d]=O,O.oldPos+1>=c&&(E=Math.min(E,d-1)),m+1>=u&&(F=Math.max(F,d+1))}s++}if(o)(function d(){setTimeout(function(){if(s>a||Date.now()>g)return o();A()||d()},0)})();else for(;s<=a&&Date.now()<=g;){var T=A();if(T)return T}},addToPath:function(e,t,r,i,o){var l=e.lastComponent;return l&&!o.oneChangePerToken&&l.added===t&&l.removed===r?{oldPos:e.oldPos+i,lastComponent:{count:l.count+1,added:t,removed:r,previousComponent:l.previousComponent}}:{oldPos:e.oldPos+i,lastComponent:{count:1,added:t,removed:r,previousComponent:l}}},extractCommon:function(e,t,r,i,o){for(var l=t.length,f=r.length,u=e.oldPos,c=u-i,s=0;c+1<l&&u+1<f&&this.equals(r[u+1],t[c+1],o);)c++,u++,s++,o.oneChangePerToken&&(e.lastComponent={count:1,previousComponent:e.lastComponent,added:!1,removed:!1});return s&&!o.oneChangePerToken&&(e.lastComponent={count:s,previousComponent:e.lastComponent,added:!1,removed:!1}),e.oldPos=u,c},equals:function(e,t,r){return r.comparator?r.comparator(e,t):e===t||r.ignoreCase&&e.toLowerCase()===t.toLowerCase()},removeEmpty:function(e){for(var t=[],r=0;r<e.length;r++)e[r]&&t.push(e[r]);return t},castInput:function(e){return e},tokenize:function(e){return Array.from(e)},join:function(e){return e.join("")},postProcess:function(e){return e}};function ve(n,e,t,r,i){for(var o=[],l;e;)o.push(e),l=e.previousComponent,delete e.previousComponent,e=l;o.reverse();for(var f=0,u=o.length,c=0,s=0;f<u;f++){var a=o[f];if(a.removed)a.value=n.join(r.slice(s,s+a.count)),s+=a.count;else{if(!a.added&&i){var p=t.slice(c,c+a.count);p=p.map(function(g,v){var m=r[s+v];return m.length>g.length?m:g}),a.value=n.join(p)}else a.value=n.join(t.slice(c,c+a.count));c+=a.count,a.added||(s+=a.count)}}return o}var Nn=new b;function me(n,e){var t;for(t=0;t<n.length&&t<e.length;t++)if(n[t]!=e[t])return n.slice(0,t);return n.slice(0,t)}function ge(n,e){var t;if(!n||!e||n[n.length-1]!=e[e.length-1])return"";for(t=0;t<n.length&&t<e.length;t++)if(n[n.length-(t+1)]!=e[e.length-(t+1)])return n.slice(-t);return n.slice(-t)}function X(n,e,t){if(n.slice(0,e.length)!=e)throw Error("string ".concat(JSON.stringify(n)," doesn't start with prefix ").concat(JSON.stringify(e),"; this is a bug"));return t+n.slice(e.length)}function Z(n,e,t){if(!e)return n+t;if(n.slice(-e.length)!=e)throw Error("string ".concat(JSON.stringify(n)," doesn't end with suffix ").concat(JSON.stringify(e),"; this is a bug"));return n.slice(0,-e.length)+t}function H(n,e){return X(n,e,"")}function P(n,e){return Z(n,e,"")}function he(n,e){return e.slice(0,Pe(n,e))}function Pe(n,e){var t=0;n.length>e.length&&(t=n.length-e.length);var r=e.length;n.length<e.length&&(r=n.length);var i=Array(r),o=0;i[0]=0;for(var l=1;l<r;l++){for(e[l]==e[o]?i[l]=i[o]:i[l]=o;o>0&&e[l]!=e[o];)o=i[o];e[l]==e[o]&&o++}o=0;for(var f=t;f<n.length;f++){for(;o>0&&n[f]!=e[o];)o=i[o];n[f]==e[o]&&o++}return o}var _="a-zA-Z0-9_\\u{C0}-\\u{FF}\\u{D8}-\\u{F6}\\u{F8}-\\u{2C6}\\u{2C8}-\\u{2D7}\\u{2DE}-\\u{2FF}\\u{1E00}-\\u{1EFF}",_e=new RegExp("[".concat(_,"]+|\\s+|[^").concat(_,"]"),"ug"),J=new b;J.equals=function(n,e,t){return t.ignoreCase&&(n=n.toLowerCase(),e=e.toLowerCase()),n.trim()===e.trim()};J.tokenize=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t;if(e.intlSegmenter){if(e.intlSegmenter.resolvedOptions().granularity!="word")throw new Error('The segmenter passed must have a granularity of "word"');t=Array.from(e.intlSegmenter.segment(n),function(o){return o.segment})}else t=n.match(_e)||[];var r=[],i=null;return t.forEach(function(o){/\s/.test(o)?i==null?r.push(o):r.push(r.pop()+o):/\s/.test(i)?r[r.length-1]==i?r.push(r.pop()+o):r.push(i+o):r.push(o),i=o}),r};J.join=function(n){return n.map(function(e,t){return t==0?e:e.replace(/^\s+/,"")}).join("")};J.postProcess=function(n,e){if(!n||e.oneChangePerToken)return n;var t=null,r=null,i=null;return n.forEach(function(o){o.added?r=o:o.removed?i=o:((r||i)&&ye(t,i,r,o),t=o,r=null,i=null)}),(r||i)&&ye(t,i,r,null),n};function ye(n,e,t,r){if(e&&t){var i=e.value.match(/^\s*/)[0],o=e.value.match(/\s*$/)[0],l=t.value.match(/^\s*/)[0],f=t.value.match(/\s*$/)[0];if(n){var u=me(i,l);n.value=Z(n.value,l,u),e.value=H(e.value,u),t.value=H(t.value,u)}if(r){var c=ge(o,f);r.value=X(r.value,f,c),e.value=P(e.value,c),t.value=P(t.value,c)}}else if(t)n&&(t.value=t.value.replace(/^\s*/,"")),r&&(r.value=r.value.replace(/^\s*/,""));else if(n&&r){var s=r.value.match(/^\s*/)[0],a=e.value.match(/^\s*/)[0],p=e.value.match(/\s*$/)[0],g=me(s,a);e.value=H(e.value,g);var v=ge(H(s,g),p);e.value=P(e.value,v),r.value=X(r.value,s,v),n.value=Z(n.value,s,s.slice(0,s.length-v.length))}else if(r){var m=r.value.match(/^\s*/)[0],F=e.value.match(/\s*$/)[0],E=he(F,m);e.value=P(e.value,E)}else if(n){var A=n.value.match(/\s*$/)[0],T=e.value.match(/^\s*/)[0],d=he(A,T);e.value=H(e.value,d)}}var qe=new b;qe.tokenize=function(n){var e=new RegExp("(\\r?\\n)|[".concat(_,"]+|[^\\S\\n\\r]+|[^").concat(_,"]"),"ug");return n.match(e)||[]};var j=new b;j.tokenize=function(n,e){e.stripTrailingCr&&(n=n.replace(/\r\n/g,`
`));var t=[],r=n.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var i=0;i<r.length;i++){var o=r[i];i%2&&!e.newlineIsToken?t[t.length-1]+=o:t.push(o)}return t};j.equals=function(n,e,t){return t.ignoreWhitespace?((!t.newlineIsToken||!n.includes(`
`))&&(n=n.trim()),(!t.newlineIsToken||!e.includes(`
`))&&(e=e.trim())):t.ignoreNewlineAtEof&&!t.newlineIsToken&&(n.endsWith(`
`)&&(n=n.slice(0,-1)),e.endsWith(`
`)&&(e=e.slice(0,-1))),b.prototype.equals.call(this,n,e,t)};function we(n,e,t){return j.diff(n,e,t)}var Je=new b;Je.tokenize=function(n){return n.split(/(\S.+?[.!?])(?=\s+|$)/)};var je=new b;je.tokenize=function(n){return n.split(/([{}:;,]|\s+)/)};function xe(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function q(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?xe(Object(t),!0).forEach(function(r){Ye(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):xe(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function ke(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Ve(n){var e=ke(n,"string");return typeof e=="symbol"?e:e+""}function K(n){return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(n)}function Ye(n,e,t){return e=Ve(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Q(n){return $e(n)||Ge(n)||Qe(n)||Xe()}function $e(n){if(Array.isArray(n))return ee(n)}function Ge(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Qe(n,e){if(n){if(typeof n=="string")return ee(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ee(n,e)}}function ee(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Xe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var W=new b;W.useLongestToken=!0;W.tokenize=j.tokenize;W.castInput=function(n,e){var t=e.undefinedReplacement,r=e.stringifyReplacer,i=r===void 0?function(o,l){return typeof l>"u"?t:l}:r;return typeof n=="string"?n:JSON.stringify(ne(n,null,null,i),i,"  ")};W.equals=function(n,e,t){return b.prototype.equals.call(W,n.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"),t)};function ne(n,e,t,r,i){e=e||[],t=t||[],r&&(n=r(i,n));var o;for(o=0;o<e.length;o+=1)if(e[o]===n)return t[o];var l;if(Object.prototype.toString.call(n)==="[object Array]"){for(e.push(n),l=new Array(n.length),t.push(l),o=0;o<n.length;o+=1)l[o]=ne(n[o],e,t,r,i);return e.pop(),t.pop(),l}if(n&&n.toJSON&&(n=n.toJSON()),K(n)==="object"&&n!==null){e.push(n),l={},t.push(l);var f=[],u;for(u in n)Object.prototype.hasOwnProperty.call(n,u)&&f.push(u);for(f.sort(),o=0;o<f.length;o+=1)u=f[o],l[u]=ne(n[u],e,t,r,u);e.pop(),t.pop()}else l=n;return l}var te=new b;te.tokenize=function(n){return n.slice()};te.join=te.removeEmpty=function(n){return n};function Le(n,e,t,r,i,o,l){if(l||(l={}),typeof l=="function"&&(l={callback:l}),typeof l.context>"u"&&(l.context=4),l.newlineIsToken)throw new Error("newlineIsToken may not be used with patch-generation functions, only with diffing functions");if(l.callback){var f=l,u=f.callback;we(t,r,q(q({},l),{},{callback:function(a){var p=c(a);u(p)}}))}else return c(we(t,r,l));function c(s){if(!s)return;s.push({value:"",lines:[]});function a(M){return M.map(function(w){return" "+w})}for(var p=[],g=0,v=0,m=[],F=1,E=1,A=function(){var w=s[T],y=w.lines||Ze(w.value);if(w.lines=y,w.added||w.removed){var se;if(!g){var ae=s[T-1];g=F,v=E,ae&&(m=l.context>0?a(ae.lines.slice(-l.context)):[],g-=m.length,v-=m.length)}(se=m).push.apply(se,Q(y.map(function(Ie){return(w.added?"+":"-")+Ie}))),w.added?E+=y.length:F+=y.length}else{if(g)if(y.length<=l.context*2&&T<s.length-2){var fe;(fe=m).push.apply(fe,Q(a(y)))}else{var ue,k=Math.min(y.length,l.context);(ue=m).push.apply(ue,Q(a(y.slice(0,k))));var Ce={oldStart:g,oldLines:F-g+k,newStart:v,newLines:E-v+k,lines:m};p.push(Ce),g=0,v=0,m=[]}F+=y.length,E+=y.length}},T=0;T<s.length;T++)A();for(var d=0,O=p;d<O.length;d++)for(var x=O[d],h=0;h<x.lines.length;h++)x.lines[h].endsWith(`
`)?x.lines[h]=x.lines[h].slice(0,-1):(x.lines.splice(h+1,0,"\\ No newline at end of file"),h++);return{oldFileName:n,newFileName:e,oldHeader:i,newHeader:o,hunks:p}}}function re(n){if(Array.isArray(n))return n.map(re).join(`
`);var e=[];n.oldFileName==n.newFileName&&e.push("Index: "+n.oldFileName),e.push("==================================================================="),e.push("--- "+n.oldFileName+(typeof n.oldHeader>"u"?"":"	"+n.oldHeader)),e.push("+++ "+n.newFileName+(typeof n.newHeader>"u"?"":"	"+n.newHeader));for(var t=0;t<n.hunks.length;t++){var r=n.hunks[t];r.oldLines===0&&(r.oldStart-=1),r.newLines===0&&(r.newStart-=1),e.push("@@ -"+r.oldStart+","+r.oldLines+" +"+r.newStart+","+r.newLines+" @@"),e.push.apply(e,r.lines)}return e.join(`
`)+`
`}function be(n,e,t,r,i,o,l){var f;if(typeof l=="function"&&(l={callback:l}),(f=l)!==null&&f!==void 0&&f.callback){var c=l,s=c.callback;Le(n,e,t,r,i,o,q(q({},l),{},{callback:function(p){p?s(re(p)):s()}}))}else{var u=Le(n,e,t,r,i,o,l);return u?re(u):void 0}}function Ze(n){var e=n.endsWith(`
`),t=n.split(`
`).map(function(r){return r+`
`});return e?t.pop():t.push(t.pop().slice(0,-1)),t}var In=new RegExp(`^<${G}>[\\s\\S]*?<\\/${G}>\\s+`,"g");function Fe(n,e){let t={},r=!1;for(let[i,o]of e){let l=n[i];if(l?.type!=="file")continue;let f=Ke(i,o,l.content);f&&(r=!0,f.length>l.content.length?t[i]={type:"file",content:l.content}:t[i]={type:"diff",content:f})}if(r)return t}function Ke(n,e,t){let r=be(n,n,e,t),i=`--- ${n}
+++ ${n}
`,o=r.indexOf(i);if(o>=0&&(r=r.slice(o+i.length)),r!=="")return r}var Te=import.meta.env.VITE_LOG_LEVEL??import.meta.env.DEV?"debug":"info",en="HTMLRewriter"in globalThis,nn=!en;function ie(n){return{trace:(...e)=>R("trace",n,e),debug:(...e)=>R("debug",n,e),info:(...e)=>R("info",n,e),warn:(...e)=>R("warn",n,e),error:(...e)=>R("error",n,e),setLevel:tn}}function tn(n){(n==="trace"||n==="debug")&&import.meta.env.PROD||(Te=n)}function R(n,e,t){let r=["trace","debug","info","warn","error"];if(r.indexOf(n)<r.indexOf(Te))return;let i=t.reduce((s,a)=>s.endsWith(`
`)?s+a:s?`${s} ${a}`:a,"");if(!nn){console.log(`[${n.toUpperCase()}]`,i);return}let o=rn(n),f=Ee(o,n==="warn"?"black":"white"),u=Ee("#77828D","white"),c=[f];typeof e=="string"&&c.push("",u),console.log(`%c${n.toUpperCase()}${e?`%c %c${e}`:""}`,...c,i)}function Ee(n,e){return`background-color: ${n}; color: white; border: 4px solid ${n}; color: ${e};`}function rn(n){switch(n){case"trace":case"debug":return"#77828D";case"info":return"#1389FD";case"warn":return"#FFDB6C";case"error":return"#EE4744";default:return"black"}}var Hn=ie("Render");function Oe(n){throw new Error(`Unreachable: ${n}`)}function on(n){let e=new Uint8Array(n),t=Math.min(e.length,512);if(t>=2&&(e[0]===255&&e[1]===254||e[0]===254&&e[1]===255)||t>=3&&e[0]===239&&e[1]===187&&e[2]===191)return!1;let r=0,i=0;for(let o=0;o<t;o++)if(e[o]===0?r++:(e[o]<7||e[o]>14&&e[o]<32)&&i++,r>t*.1||i>t*.3)return!0;return!1}function Se(n){return!on(n)}function Bn(n){let e=n.split("/");return e.pop(),e.join("/")||"."}function Ne(n,e){let t=n.split("/").filter(Boolean),r=e.split("/").filter(Boolean),i=0;for(;i<t.length&&i<r.length&&t[i]===r[i];)i++;let o=t.length-i;return Array(o).fill("..").concat(r.slice(i)).join("/")||"."}var Ae=ie("FilesStore"),ln=new TextDecoder("utf8",{fatal:!0}),oe=class{#e;#t=0;#n=new Map;files=D({});get filesCount(){return this.#t}constructor(e){this.#e=e,this.#r()}getFile(e){let t=this.files.get()[e];if(t?.type==="file")return t}getFileModifications(){return Fe(this.files.get(),this.#n)}resetFileModifications(){this.#n.clear()}async saveFile(e,t){let r=await this.#e;try{let i=Ne(r.workdir,e);if(!i)throw new Error(`EINVAL: invalid file path, write '${i}'`);let o=this.getFile(e)?.content;o||Oe("Expected content to be defined"),await r.fs.writeFile(i,t),this.#n.has(e)||this.#n.set(e,o),this.files.setKey(e,{type:"file",content:t,isBinary:!1}),Ae.info("File updated")}catch(i){throw Ae.error(`Failed to update file content

`,i),i}}async#r(){(await this.#e).internal.watchPaths({include:[`${pe}/**`],exclude:["**/node_modules",".git"],includeContent:!0},de(100,this.#i.bind(this)))}#i(e){let t=e.flat(2);for(let{type:r,path:i,buffer:o}of t){let l=i.replace(/\/+$/g,"");switch(r){case"add_dir":{this.files.setKey(l,{type:"folder"});break}case"remove_dir":{this.files.setKey(l,void 0);for(let[f]of Object.entries(this.files))f.startsWith(l)&&this.files.setKey(f,void 0);break}case"add_file":case"change":{r==="add_file"&&this.#t++;let f="",u=sn(o);u||(f=this.#o(o)),this.files.setKey(l,{type:"file",content:f,isBinary:u});break}case"remove_file":{this.#t--,this.files.setKey(l,void 0);break}case"update_directory":break}}}#o(e){if(!e||e.byteLength===0)return"";try{return ln.decode(e)}catch(t){return console.log(t),""}}};function sn(n){return n===void 0?!1:Se(n)}var Me=new oe(Promise.resolve(new WebContainer));var le=class{#e;selectedFile=N();documents=D({});currentDocument=V([this.documents,this.selectedFile],(e,t)=>{if(t)return e[t]});constructor(e){this.#e=e}setDocuments(e){let t=this.documents.value;this.documents.set(Object.fromEntries(Object.entries(e).map(([r,i])=>{if(i===void 0||i.type==="folder")return;let o=t?.[r];return[r,{value:i.content,filePath:r,scroll:o?.scroll}]}).filter(Boolean)))}setSelectedFile(e){this.selectedFile.set(e)}updateScrollPosition(e,t){let i=this.documents.get()[e];i&&this.documents.setKey(e,{...i,scroll:t})}updateFile(e,t){let i=this.documents.get()[e];if(!i)return;i.value!==t&&this.documents.setKey(e,{...i,value:t})}},Xn=new le(Me);export{N as a,D as b,En as c,ze as d,ie as e,Oe as f,Bn as g,oe as h,le as i,Xn as j};
